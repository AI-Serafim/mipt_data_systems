# Домашнее задание 6. Автоматизация расчетов с помощью Apache AirFlow

## Цель задания
Научиться писать DAG в Apache AirFlow для автоматизации расчетов.

## Условия для выполнения
Даны csv-файлы:
- Данные о клиентах
- Данные о продуктах
- Данные о заказах
- Данные, связывающие заказы и продукты

## Как выполнять задание
### Шаг 1. Создать Airflow DAG, который будет ежедневно выполнять следующие действия:
загружать данные из файлов с локальной директории в соответствующие таблицы (параллельные task-и):
- о клиентах — customer;
- о продуктах — product;
- о заказах — orders;
- связывающие заказы и продукты — order_items.

### Шаг 2. Далее выполнить следующие запросы, записав ответы в отдельные файлы (параллельные task):
- Найти имена и фамилии клиентов с ТОП-3 минимальной и ТОП-3 максимальной суммой транзакций за весь период (учесть клиентов, у которых нет заказов).
- Найти ТОП-5 клиентов (по общему доходу) в каждом сегменте благосостояния (wealth_segment). Вывести имя, фамилию, сегмент и общий доход. Если в сегменте менее 5 клиентов, вывести всех.

### Шаг 3. Проверить, что запросы из пункта выше не вернули нулевое количество строк. В случае непрохождения проверки отправить уведомление на почту.

### Шаг 4. Вывести сообщение об успешном или неуспешном выполнении DAG.